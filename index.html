<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>pied piper-blog by SlienceH</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <!-- <section class="page-header">
      <h1 class="project-name">pied piper-blog</h1>
      <h2 class="project-tagline"></h2>
      <a href="https://github.com/SlienceH/blog" class="btn">View on GitHub</a>
      <a href="https://github.com/SlienceH/blog/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/SlienceH/blog/tarball/master" class="btn">Download .tar.gz</a>
    </section> -->

    <section class="main-content">
      <h3>
<a id="缓存" class="anchor" href="#%E7%BC%93%E5%AD%98" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>缓存</h3>

<p>缓存按照数据存放介质分类： 1、 内存缓存  2、文件缓存
   缓存按照存放的数据分类： 1、 数据缓存    2、 页面静态化</p>

<pre><code>    数据缓存：只保存数据库中的数据
    页面静态化：将动态页面变成静态页面
</code></pre>

<p>缓存按照存放服务器位置分类： 1、 本地缓存   2、远程缓存</p>

<pre><code>    本地缓存：就是将数据存放到应用服务器的就是本地缓存
    远程缓存： 缓存数据不再应用服务器
</code></pre>

<p>缓存作用： 1、减少对数据库查询   2、加快查询速度 </p>

<p>如何做缓存： </p>

<pre><code>   在缓存之前，首先得选择做哪种缓存。 选择数据缓存还是页面静态化？  
</code></pre>

<p>数据缓存特点：只是保存数据，并且数据一般保存到内存中。
页面静态化特点： 保存整个页面，这个页面一般保存到文件中。 </p>

<pre><code> 如果是类似于文章页的页面，应该选择页面静态化。 特点：页面改动不大的页面，都应该选择页面静态化。

 如果类似商品详情页，应该选择数据缓存。原因是： 商品详情页的数据经常发生改变。特点：如果页面的数据经常发生改变，应该选择数据缓存。
</code></pre>

<p>确定选择缓存类型为数据缓存，接下来问题是,将哪些数据缓存到memcache， 将热数据缓存到内存中。</p>

<p>一个非热数据变成热数据，应该找个数据找到，然后缓存到内存中。
  找个功能如何实现：  写一个计划任务，这个任务定时在每天凌晨的4点，定时执行一个php文件，php文件里面的代码： 先去查数据库得到热数据， 然后将热数据存放到memcache。</p>

<p>第二天用户来购买、浏览商品，这个时候用户读取的数据其实都是从memcache拿出来。</p>

<p>goods
   id   gname        view(访问量)
    1    瓦           1                      10000万 
    2   jj           1000</p>

<h3>
<a id="缓存时间的问题" class="anchor" href="#%E7%BC%93%E5%AD%98%E6%97%B6%E9%97%B4%E7%9A%84%E9%97%AE%E9%A2%98" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>缓存时间的问题</h3>

<p>1、缓存时间缓存多久</p>

<pre><code>    应该根据数据变化特点来设定缓存时间
</code></pre>

<p>2、 缓存时间都一样可以吗？</p>

<pre><code>    缓存时间不能设置成一样，原因是：缓存失效后会同时去查询数据库，这个数据库压力上升。
    缓存时间最好有一个时间差。
</code></pre>

<h2>
<a id="热数据" class="anchor" href="#%E7%83%AD%E6%95%B0%E6%8D%AE" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>热数据</h2>

<p>经常被查的数据就是热数据。
  热数据有： 1、 热销商品  2、 点击量高商品  3、 首页数据 </p>

<h2>
<a id="请问你使用过memcache吗你的项目是如何运用的" class="anchor" href="#%E8%AF%B7%E9%97%AE%E4%BD%A0%E4%BD%BF%E7%94%A8%E8%BF%87memcache%E5%90%97%E4%BD%A0%E7%9A%84%E9%A1%B9%E7%9B%AE%E6%98%AF%E5%A6%82%E4%BD%95%E8%BF%90%E7%94%A8%E7%9A%84" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>请问你使用过Memcache吗，你的项目是如何运用的？</h2>

<p>使用过， 首先我会将一些热数据查询出来，比如热销商品。然后通过memcache将热数据存放到内存中。</p>

<h2>
<a id="增加应用服务器" class="anchor" href="#%E5%A2%9E%E5%8A%A0%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>增加应用服务器</h2>

<p>原来只有一台应用服务器，现在有3台应用服务器。 如何架构应用服务器？ </p>

<p>负载均衡器的作用：起到分发请求给不同的应用服务器的作用。
其中哪些东西可以做到负载据衡器的功能： 1、nginx  2、 LVS （开源免费软件）  3、 F5(硬件，价格贵)</p>

<h2>
<a id="冗余技术" class="anchor" href="#%E5%86%97%E4%BD%99%E6%8A%80%E6%9C%AF" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>冗余技术</h2>

<p>冗余技术： 增加多余的设备，以保证系统可靠性。</p>

<h2>
<a id="搭建应用服务器集群需要注意的问题" class="anchor" href="#%E6%90%AD%E5%BB%BA%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%9B%86%E7%BE%A4%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E9%97%AE%E9%A2%98" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>搭建应用服务器集群需要注意的问题</h2>

<p>1、 每台应用服务器的代码都是一样
 2、 SESSION数据无法共享问题</p>

<pre><code>    解决方案：1、将SESSION的数据存放到数据库中  2、Memcache中
</code></pre>

<h3>
<a id="session" class="anchor" href="#session" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>SESSION</h3>

<ol>
<li>SESSION默认情况下是通过文件方式保存起来的，但是我们可以改变SESSION保存方式（ user/memcache ）  user:可以将SESSION存放到数据库中</li>
</ol>

<h2>
<a id="数据库读写分离" class="anchor" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>数据库读写分离</h2>

<p>通过增加数据库服务器数量，将数量变成5台。  第一台数据库服务器负责网站写操作，叫做主库，第二台给主库搞一个备份，第3/4/5都是负责读操作，叫做从库。为什么从库需要三台服务器，因为查得多。</p>

<p>主库(254)：负责写   insert into user(name) values('jack');</p>

<p>从库(253):负责读   select * from user where name = 'jack';</p>

<p>读写分离原理：  主库写的SQl语句都会被记录下来，被记录到一个叫做bin-log(二进制日志文件中)，</p>

<p>从库复制主库的bin-log文件，然后重新执行一次，数据就同步了。</p>

<h2>
<a id="数据库读写分离常见方案" class="anchor" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB%E5%B8%B8%E8%A7%81%E6%96%B9%E6%A1%88" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>数据库读写分离常见方案</h2>

<p>1、利用bin-log实现
  2、 利用proxy360这个软件实现</p>

     <!--  <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/SlienceH/blog">pied piper-blog</a> is maintained by <a href="https://github.com/SlienceH">SlienceH</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer> -->

    </section>

  
  </body>
</html>
